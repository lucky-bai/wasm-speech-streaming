<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>WASM Streaming Speech Recognition</title>
    <style>
      @import url("https://fonts.googleapis.com/css2?family=Source+Sans+3:wght@300;400;600;700&display=swap");
      html, body { font-family: "Source Sans 3", system-ui, -apple-system, Segoe UI, Roboto, sans-serif; }
    </style>
    <script src="css/tailwind-3.4.17.js"></script>
    <script type="module" src="js/speech-recognition.js"></script>
  </head>
  <body class="container max-w-4xl mx-auto p-4">
    <main class="grid grid-cols-1 gap-8 relative">
      <div>
        <h1 class="text-4xl font-bold">WASM Streaming Speech Recognition</h1>
        <p class="text-gray-700">
          Transcribe audio from your microphone in real time in the browser using Rust/WASM.
          This demo runs entirely offline on your CPU after downloading a ~950 MB model.
          It understands English and French, and uses the
          <a href="https://huggingface.co/kyutai/stt-1b-en_fr" target="_blank" class="underline hover:text-blue-600">Kyutai STT model</a>
          together with a WASM runtime built in 
          <a href="https://github.com/huggingface/candle/" target="_blank" class="underline hover:text-blue-600">Candle</a>.
        </p>
      </div>

      <div>
        <button id="speech-button" class="bg-gray-700 hover:bg-gray-800 text-white font-normal py-2 px-4 rounded">
          Start Speech
        </button>
        <div class="mt-2 text-gray-600 text-sm space-y-1">
          <div>Status: <span id="status-div">Click "Start Speech" to begin</span></div>
          <div id="diagnostics">CPUs: -, Real-time factor: 0.00x, Duration: 0.0s</div>
        </div>
      </div>

      <div>
        <h3 class="font-medium">Transcription:</h3>
        <div class="min-h-[200px] bg-slate-100 text-gray-700 p-4 rounded-md">
          <p id="output-generation" hidden></p>
          <span id="output-placeholder" class="font-light text-gray-500">Click "Start Speech" to begin transcription</span>
        </div>
      </div>

      <div class="mt-4 p-3 bg-gray-50 text-gray-700 rounded-md">
        ðŸ’¡ This demo shows offline transcription in your browser.  
        For more accurate cloud transcription and real-time LLM grammar correction, check out  
        <a href="https://voicewriter.io" target="_blank" class="underline hover:text-blue-600">Voice Writer</a>.
      </div>
    </main>
  </body>
</html>